<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title th:text="${blog.blogTitle}">News Detail</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --primary-purple: #00ff87;
            --dark-purple: #00ff87;
            --light-purple: #00ff87;
            --purple-gradient: linear-gradient(135deg, #00ff87 0%, #000000 100%);
            --text-dark: #1F2937;
            --text-light: #6B7280;
            --bg-light: #FAFBFC;
            --border-light: #E5E7EB;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-light);
            color: var(--text-dark);
            line-height: 1.6;
        }

        /* Header Article */
        .article-header {
            background: var(--purple-gradient);
            color: white;
            padding: 80px 0 60px;
            position: relative;
            overflow: hidden;
        }

        .article-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="white" opacity="0.05"/><circle cx="75" cy="75" r="1" fill="white" opacity="0.05"/><circle cx="50" cy="10" r="0.5" fill="white" opacity="0.03"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            opacity: 0.3;
        }

        .article-header .container {
            position: relative;
            z-index: 2;
        }

        .article-category {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            padding: 8px 20px;
            border-radius: 50px;
            font-size: 14px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 24px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .article-title {
            font-family: 'Playfair Display', serif;
            font-size: clamp(2rem, 5vw, 3.5rem);
            font-weight: 700;
            line-height: 1.2;
            margin-bottom: 32px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .article-meta {
            display: flex;
            align-items: center;
            gap: 32px;
            font-size: 16px;
            opacity: 0.9;
        }

        .article-date {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .article-date::before {
            content: '';
            width: 6px;
            height: 6px;
            background: currentColor;
            border-radius: 50%;
            opacity: 0.6;
        }

        /* Main Content */
        .article-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 80px 20px;
        }

        .article-image {
            width: 100%;
            max-height: 500px;
            object-fit: cover;
            border-radius: 16px;
            margin-bottom: 48px;
            box-shadow: 0 20px 40px rgba(139, 92, 246, 0.1);
            transition: all 0.6s ease;
        }

        .article-image:hover {
            transform: translateY(-8px);
            box-shadow: 0 30px 60px rgba(139, 92, 246, 0.15);
        }

        .article-subtitle {
            font-family: 'Playfair Display', serif;
            font-size: 24px;
            font-weight: 600;
            color: var(--primary-purple);
            margin-bottom: 32px;
            position: relative;
        }

        .article-subtitle::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 60px;
            height: 3px;
            background: var(--purple-gradient);
            border-radius: 2px;
        }

        .article-body {
            font-size: 18px;
            line-height: 1.8;
            color: var(--text-dark);
        }

        .article-body p {
            margin-bottom: 24px;
            transition: all 0.3s ease;
        }

        .article-body p:hover {
            color: var(--primary-purple);
            transform: translateX(4px);
        }

        .article-body h2,
        .article-body h3,
        .article-body h4 {
            font-family: 'Playfair Display', serif;
            color: var(--primary-purple);
            margin: 40px 0 20px;
            font-weight: 600;
        }

        .article-body blockquote {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.05) 0%, rgba(124, 58, 237, 0.05) 100%);
            border-left: 4px solid var(--primary-purple);
            padding: 24px 32px;
            margin: 32px 0;
            border-radius: 0 12px 12px 0;
            font-style: italic;
            font-size: 20px;
            position: relative;
        }

        .article-body blockquote::before {
            content: '"';
            font-size: 60px;
            color: var(--light-purple);
            position: absolute;
            top: -10px;
            left: 12px;
            font-family: 'Playfair Display', serif;
        }

        /* Related Articles */
        .related-section {
            background: white;
            padding: 80px 0;
            margin-top: 60px;
        }

        .section-title {
            font-family: 'Playfair Display', serif;
            font-size: 36px;
            font-weight: 600;
            color: var(--primary-purple);
            text-align: center;
            margin-bottom: 60px;
            position: relative;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -12px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: var(--purple-gradient);
            border-radius: 2px;
        }

        .related-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(139, 92, 246, 0.08);
            transition: all 0.4s ease;
            height: 100%;
            border: 1px solid rgba(139, 92, 246, 0.1);
        }

        .related-card:hover {
            transform: translateY(-12px);
            box-shadow: 0 25px 50px rgba(139, 92, 246, 0.15);
            border-color: var(--light-purple);
        }

        .related-card-image {
            width: 100%;
            height: 220px;
            object-fit: cover;
            transition: all 0.6s ease;
        }

        .related-card:hover .related-card-image {
            transform: scale(1.05);
        }

        .related-card-body {
            padding: 24px;
        }

        .related-card-title {
            font-family: 'Playfair Display', serif;
            font-size: 20px;
            font-weight: 600;
            color: var(--text-dark);
            line-height: 1.4;
            margin-bottom: 0;
            transition: all 0.3s ease;
        }

        .related-card:hover .related-card-title {
            color: var(--primary-purple);
        }

        .no-related {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-light);
            font-size: 18px;
            font-style: italic;
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(40px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-40px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* Page animations */
        .article-header {
            animation: fadeInUp 1s ease-out;
        }

        .article-category {
            animation: slideInLeft 1s ease-out 0.3s both;
        }

        .article-title {
            animation: fadeInUp 1s ease-out 0.5s both;
        }

        .article-meta {
            animation: slideInLeft 1s ease-out 0.7s both;
        }

        .article-content {
            animation: fadeInUp 1s ease-out 0.9s both;
        }

        .article-image {
            animation: scaleIn 1s ease-out 1.1s both;
        }

        .article-subtitle {
            animation: slideInLeft 0.8s ease-out 1.3s both;
        }

        .article-body {
            animation: fadeInUp 0.8s ease-out 1.5s both;
        }

        .related-section {
            animation: fadeInUp 1s ease-out 1.7s both;
        }

        .related-card {
            animation: fadeInUp 0.8s ease-out calc(1.9s + var(--delay, 0s)) both;
        }

        .related-card:nth-child(1) {
            --delay: 0s;
        }

        .related-card:nth-child(2) {
            --delay: 0.2s;
        }

        .related-card:nth-child(3) {
            --delay: 0.4s;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .article-header {
                padding: 60px 0 40px;
            }

            .article-content {
                padding: 60px 20px;
            }

            .article-meta {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }

            .article-body {
                font-size: 16px;
            }

            .related-section {
                padding: 60px 0;
            }
        }

        /* Scroll effects */
        .scroll-reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease;
        }

        .scroll-reveal.revealed {
            opacity: 1;
            transform: translateY(0);
        }

        /* Enhanced focus states */
        .related-card:focus-within {
            outline: 2px solid var(--primary-purple);
            outline-offset: 4px;
        }

        /* Loading states */
        .loading-shimmer {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }

        @keyframes shimmer {
            0% {
                background-position: 200% 0;
            }

            100% {
                background-position: -200% 0;
            }
        }
    </style>
</head>

<body>
    <div th:replace="fragments/header :: siteHeader"></div>
    <div th:replace="fragments/chatbox :: chatBoxFragment"></div>
    <!-- Article Header -->
    <header class="article-header">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-10 col-xl-8">
                    <div class="article-category">News</div>
                    <h1 class="article-title" th:text="${blog.blogTitle}">Sample Headline That Could Be Very Long and
                        Interesting</h1>
                    <div class="article-meta">
                        <div class="article-date" th:text="${#temporals.format(blog.blogDateCreated, 'dd MMMM yyyy')}">
                            17 June 2025</div>
                        <div class="reading-time">5 phút đọc</div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Article Content -->
    <main class="article-content">
        <img class="article-image" th:src="@{{img}(img=${blog.blogThumnailPath})}" alt="Article Image" loading="lazy">

        <h2 class="article-subtitle" th:text="${blog.blogTitle}">Sub headline or summary that provides additional
            context</h2>

        <div class="article-body" th:utext="${blog.blogContent}">
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et
                dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip
                ex ea commodo consequat.</p>

            <p>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.
                Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est
                laborum.</p>

            <blockquote>
                This is a sample quote that demonstrates how blockquotes will look in the article. They have a special
                styling with purple accent.
            </blockquote>

            <p>Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam
                rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt
                explicabo.</p>
        </div>
    </main>
    <!-- Bình luận bài viết -->
    <div class="section slide-up p-4 mb-5 shadow-sm rounded border bg-white container">
        <h4><i class="bi bi-chat-left-dots me-2"></i>Bình luận bài viết</h4>

        <!-- Nếu người dùng đã đăng nhập thì cho phép bình luận -->
        <div sec:authorize="!isAnonymous()">
            <!-- Form Gửi bình luận -->
            <form th:action="@{'/news/comment/' + ${blog.blogId}}" method="post" class="mb-4">
                <div class="mb-3">
                    <textarea class="form-control" name="commentContent" rows="3" placeholder="Nhập bình luận..."
                        required></textarea>
                </div>
                <button type="submit" class="btn btn-primary">
                    <i class="bi bi-send me-1"></i> Gửi bình luận
                </button>
            </form>
        </div>

        <!-- Nếu chưa đăng nhập thì hiện thông báo -->
        <div sec:authorize="isAnonymous()" class="alert alert-warning">
            Vui lòng <a th:href="@{/auth/login}">đăng nhập</a> để bình luận.
        </div>

        <!-- Hiển thị danh sách bình luận -->
        <div th:if="${#lists.isEmpty(comments)}" class="text-muted fst-italic">Chưa có bình luận nào.</div>

        <div class="list-group" th:if="${not #lists.isEmpty(comments)}">
            <div th:each="c : ${comments}" class="list-group-item list-group-item-light mb-2">
                <div class="d-flex justify-content-between align-items-center">
                    <strong th:text="${c.user.username}">Username</strong>
                    <small class="text-muted"
                        th:text="${#temporals.format(c.commentDateCreated, 'dd/MM/yyyy HH:mm')}">Thời gian</small>
                </div>
                <p class="mb-0 mt-2" th:text="${c.commentContent}">Nội dung bình luận...</p>
            </div>
        </div>
    </div>



    <!-- Related Articles -->
    <section class="related-section">
        <div class="container">
            <h2 class="section-title">Bài viết liên quan</h2>

            <div th:if="${#lists.isEmpty(relatedNews)}">
                <div class="no-related">Không có bài viết liên quan nào được tìm thấy.</div>
            </div>

            <div class="row g-4" th:if="${not #lists.isEmpty(relatedNews)}">
                <div class="col-lg-4 col-md-6" th:each="related : ${relatedNews}">
                    <article class="related-card">
                        <img th:src="@{{img}(img=${related.blogThumnailPath})}" class="related-card-image"
                            alt="Related Article" loading="lazy">
                        <div class="related-card-body">
                            <h3 class="related-card-title" th:text="${related.blogTitle}">Related Article Title That
                                Could Be Long</h3>
                            <a class="stretched-link" th:href="@{/news/{id}(id=${related.blogId})}"
                                aria-label="Read full article"></a>
                        </div>
                    </article>
                </div>
            </div>

        </div>


    </section>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Scroll reveal animation
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -100px 0px'
            };

            const observer = new IntersectionObserver(function (entries) {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('revealed');
                    }
                });
            }, observerOptions);

            // Add scroll reveal to paragraphs and cards
            const scrollElements = document.querySelectorAll('.article-body p, .related-card');
            scrollElements.forEach(el => {
                el.classList.add('scroll-reveal');
                observer.observe(el);
            });

            // Enhanced image loading
            const images = document.querySelectorAll('img');
            images.forEach(img => {
                if (!img.complete) {
                    img.classList.add('loading-shimmer');
                    img.addEventListener('load', function () {
                        this.classList.remove('loading-shimmer');
                    });
                }
            });

            // Reading progress indicator
            const progressBar = document.createElement('div');
            progressBar.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 0%;
                height: 4px;
                background: linear-gradient(90deg, #8B5CF6, #7C3AED);
                z-index: 9999;
                transition: width 0.3s ease;
            `;
            document.body.appendChild(progressBar);

            window.addEventListener('scroll', function () {
                const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
                const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
                const scrolled = (winScroll / height) * 100;
                progressBar.style.width = scrolled + '%';
            });

            // Enhanced hover effects for related cards
            const relatedCards = document.querySelectorAll('.related-card');
            relatedCards.forEach(card => {
                card.addEventListener('mouseenter', function () {
                    this.style.transform = 'translateY(-12px) scale(1.02)';
                });

                card.addEventListener('mouseleave', function () {
                    this.style.transform = 'translateY(0) scale(1)';
                });
            });

            // Smooth parallax for header
            let ticking = false;
            function updateParallax() {
                const scrolled = window.pageYOffset;
                const header = document.querySelector('.article-header');
                if (header && scrolled < window.innerHeight) {
                    const rate = scrolled * -0.3;
                    header.style.transform = `translateY(${rate}px)`;
                }
                ticking = false;
            }

            window.addEventListener('scroll', function () {
                if (!ticking) {
                    requestAnimationFrame(updateParallax);
                    ticking = true;
                }
            });

            // Calculate reading time
            const articleText = document.querySelector('.article-body').textContent;
            const wordsPerMinute = 200;
            const wordCount = articleText.trim().split(/\s+/).length;
            const readingTime = Math.ceil(wordCount / wordsPerMinute);

            const readingTimeElement = document.querySelector('.reading-time');
            if (readingTimeElement) {
                readingTimeElement.textContent = `${readingTime} phút đọc`;
            }
        });
    </script>
</body>

</html>